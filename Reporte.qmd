---
lang: es
format:
  html:
    embed-resources: true
    published-title: "Fecha:"  # Cambia "Published" por "Fecha"
    title: "UNIDAD CENTINELA DE INFECCION RESPIRATORIA AGUDA GRAVE (IRAG)"
    author-title: "Autor: UCIRAG TUCUMAN / SALTA"
    toc: true                # Habilita la tabla de contenidos
    toc-title: "Índice de Contenidos"  # Título del índice
    toc-depth: 3             # Nivel de profundidad del índice (hasta h3)
    toc-location: left       # Ubicación del índice (izquierda)
    include-in-header: logo.html
    css: estilologo.css
link-citations: true
editor: visual
execute:
  warning: false
  message: false
footnotes-hover: true # muestra notas al pie
smooth-scroll: true # suaviza el scroll
code-copy: true            # Permite copiar el código desde el documento
---

```{r}
#| label: Preparacion de base de datos - UCIRAG
#| echo: false
#| message: false
#| warning: false
# -------LIBRERIAS-----------

library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(readxl)
library(writexl)
library(readr)
library(gt)

if (requireNamespace("extrafont", quietly = TRUE)) {
  library(extrafont)
} else {
  message("Paquete 'extrafont' no disponible, se omite su carga.")
}

library(leaflet)
library(geoAr)
library(highcharter)
library(tidyr)



# --------IMPORTAR BASE---------

# dfnom <- read_excel("data/Base_UC_IRAG.xlsx")

dfnom <- read_excel("data/Base _UC_IRAG.xlsx")

# readxl::read_excel("data/Base_UC_IRAG.xlsx")


# ------CONSIDERACIONES----------

#DEBO CREAR PRIMERO UNA BASE QUE NO CONTENGA LOS CASOS INVALIDADOS 
# DEBO CREAR UN NUEVO OBJETO PARA ORDENAR LOS GRUPOS DE EDAD
# LAS VARIABKE SA USAR SERAN:
# CLASIFICACION MANUAL DE CASO
# EDAD_UC_IRAG

# -----CREACION DE LA NUEVA BASE LIMPIA-------

base_limpia <- dfnom %>%
  dplyr::filter(CLASIFICACION_MANUAL != "Caso invalidado por epidemiología")

notti <- base_limpia %>% mutate( GRUPO_ETARIO= case_when( EDAD_UC_IRAG == "0 a 2 Meses" | EDAD_UC_IRAG == "3 a 5 Meses" ~ "Menor a 6 Meses",
                                                    EDAD_UC_IRAG == "6 a 11 Meses"| EDAD_UC_IRAG == "12 a 23 Meses" ~ "6 a 23 Meses ",
                                                    TRUE ~ EDAD_UC_IRAG ))


   
```

```{r}
#| label: texto enriquecido para graficos y titulos
#| message: false 
#| echo: false
#| warning: false
#| results: "hide"

source("texto_enriquecido_corregido.R")
```

# Introducción

Las infecciones respiratorias agudas (IRAs) constituyen una de las principales causas de morbimortalidad a nivel mundial, afectando especialmente a niñas y niños menores de cinco años, a adultos mayores y personas con comorbilidades como enfermedades cardiovasculares, respiratorias o inmunosupresión. Las infecciones respiratorias emergentes representan además un desafío sanitario significativo debido a su alto potencial de transmisión de persona a persona.

Frente a esta realidad, y como parte del fortalecimiento de la estrategia federal para la vigilancia de infecciones respiratorias agudas graves (IRAG), el Ministerio de Salud de la Nación impulsó en 2024 la expansión de la Red de Unidades Centinela (UC-IRAG) a las 24 jurisdicciones del país. En este contexto, y considerando que la vigilancia centinela se basa en la recolección oportuna y sistemática de datos mediante un número limitado de establecimientos seleccionados bajo criterios específicos, el Ministerio de Salud Pública de la provincia de Tucumán designó al Hospital de Clínicas Presidente Dr. Nicolás Avellaneda como sitio centinela para la implementación de la vigilancia de IRAG en la región. Esta designación permite monitorear de manera precisa y constante la circulación de agentes etiológicos responsables de IRAG.

El presente informe tiene como objetivo describir el perfil clínico, epidemiológico y de diagnóstico etiológico de las infecciones respiratorias agudas graves (IRAG) notificadas a través de la estrategia de Unidad Centinela del Hospital Avellaneda.

## Ubicación geográfica

La OMS recomienda sistemas de vigilancia centinela de hospitalizaciones por IRAG (UC-IRAG) que integren la vigilancia de virus respiratorios con potencial epidémico: SARS-CoV-2, influenza y VSR. En el hospital Avellaneda, esta vigilancia se complementa con el monitoreo ambulatorio (UMAs), coordinando aspectos clínicos, epidemiológicos y laboratoriales, para lo cual resulta necesario el trabajo conjunto y colaborativo entre el laboratorio del hospital y el Laboratorio de Salud Pública provincial.

```{r}
#| label: Ubicacion UCIRAG 
#| echo: false
#| message: false 
#| warning: false 
#|  


LISTADO_EFECTORES <- read_excel("EFECTORES.xlsx")
# Separar coordenadas en latitud y longitud
LISTADO_EFECTORES <- LISTADO_EFECTORES %>%
  mutate(
    lat = as.numeric(sub(",.*", "", Coordenadas)),
    lon = as.numeric(sub(".*,", "", Coordenadas))
  )

# Crear mapa base
mapa_efectores <- leaflet() %>%
  addArgTiles()

# Agregar hospitales (azules)
mapa_efectores <- mapa_efectores %>%
  addCircleMarkers(
    data = LISTADO_EFECTORES %>% dplyr::filter(`tipo de establecimiento` == "HOSPITAL"),
    ~lon, ~lat,
    popup = ~paste0("<b>Nombre:</b> ", Nombre, "<br>",
                    "<b>Código SISA:</b> ", `Código SISA EFECTOR`, "<br>",
                    "<b>Nivel Complejidad:</b> ", `NIVEL COMPL`, "<br>",
                    "<b>Zona Sanitaria:</b> ", `zona sanitaria`, "<br>",
                    "<b>Localidad:</b> ", LOCALIDAD, "<br>",
                    "<b>Tipo de Establecimiento:</b> ", `tipo de establecimiento`, "<br>",
                    "<b>Estrategia:</b> ", Estrategia),
    color = "blue",
    radius = 5,
    fillOpacity = 0.7
  )

# Agregar laboratorios (verdes y más pequeños)
mapa_efectores <- mapa_efectores %>%
  addCircleMarkers(
    data = LISTADO_EFECTORES %>% dplyr::filter(`tipo de establecimiento` == "LABORATORIO"),
    ~lon, ~lat,
    popup = ~paste0("<b>Nombre:</b> ", Nombre, "<br>",
                    "<b>Código SISA:</b> ", `Código SISA EFECTOR`, "<br>",
                    "<b>Nivel Complejidad:</b> ", `NIVEL COMPL`, "<br>",
                    "<b>Zona Sanitaria:</b> ", `zona sanitaria`, "<br>",
                    "<b>Localidad:</b> ", LOCALIDAD, "<br>",
                    "<b>Tipo de Establecimiento:</b> ", `tipo de establecimiento`, "<br>",
                    "<b>Estrategia:</b> ", Estrategia),
    color = "#04cc97",
    radius = 3,  # Más pequeño
    fillOpacity = 1
  )

# Agregar otros establecimientos (naranja y gris)
mapa_efectores <- mapa_efectores %>%
  addCircleMarkers(
    data = LISTADO_EFECTORES %>% dplyr::filter(!`tipo de establecimiento` %in% c("HOSPITAL", "LABORATORIO")),
    ~lon, ~lat,
    popup = ~paste0("<b>Nombre:</b> ", Nombre, "<br>",
                    "<b>Código SISA:</b> ", `Código SISA EFECTOR`, "<br>",
                    "<b>Nivel Complejidad:</b> ", `NIVEL COMPL`, "<br>",
                    "<b>Zona Sanitaria:</b> ", `zona sanitaria`, "<br>",
                    "<b>Localidad:</b> ", LOCALIDAD, "<br>",
                    "<b>Tipo de Establecimiento:</b> ", `tipo de establecimiento`, "<br>",
                    "<b>Estrategia:</b> ", Estrategia),
    color = ~case_when(
      `tipo de establecimiento` == "CENTRO DE SALUD RURAL" ~ "orange",
      TRUE ~ "gray"
    ),
    radius = 5,
    fillOpacity = 0.7
  )

# Agregar los establecimientos centinela (cruces rojas)
mapa_efectores <- mapa_efectores %>%
  addAwesomeMarkers(
    data = LISTADO_EFECTORES %>% dplyr::filter(Estrategia == "CENTINELA"),
    ~lon, ~lat,
    popup = ~paste0("<b>Nombre:</b> ", Nombre, "<br>",
                    "<b>Código SISA:</b> ", `Código SISA EFECTOR`, "<br>",
                    "<b>Nivel Complejidad:</b> ", `NIVEL COMPL`, "<br>",
                    "<b>Zona Sanitaria:</b> ", `zona sanitaria`, "<br>",
                    "<b>Localidad:</b> ", LOCALIDAD, "<br>",
                    "<b>Tipo de Establecimiento:</b> ", `tipo de establecimiento`, "<br>",
                    "<b>Estrategia:</b> ", Estrategia),
    icon = awesomeIcons(
      icon = "plus",
      library = "fa",
      markerColor = "red"
    )
  )

# Agregar leyenda
# Leyenda personalizada con HTML
# Leyenda personalizada con HTML y cruz negra
custom_legend <- htmltools::HTML('
<div style="background:white; padding: 10px; border-radius: 5px; box-shadow: 2px 2px 6px rgba(0,0,0,0.3); font-size: 14px;">
  <b>Tipos de Establecimientos</b><br>
  <i style="background:blue; width: 12px; height: 12px; display:inline-block; border-radius:50%; margin-right:6px;"></i> Hospital<br>
  <i style="background:orange; width: 12px; height: 12px; display:inline-block; border-radius:50%; margin-right:6px;"></i> Centro de Salud Rural<br>
  <i style="background:#04cc97; width: 12px; height: 12px; display:inline-block; border-radius:50%; margin-right:6px;"></i> Laboratorio<br>
  <i style="background:gray; width: 12px; height: 12px; display:inline-block; border-radius:50%; margin-right:6px;"></i> Otro<br>
  <i class="fa fa-plus" style="color:black; background:#cc0415; border-radius: 50%; padding: 2px 5px; margin-right:6px;"></i> Unidad Centinela de IRAG
</div>
')

mapa_efectores <- mapa_efectores %>%
  addControl(custom_legend, position = "bottomright")

mapa_efectores

```

## Metodología

Para el presente analisis se consideraron los casos de IRAG e IRAG extendida definidos como:

1.  **Infección Respiratoria Aguda Grave (IRAG):** Paciente de cualquier edad con infección respiratoria aguda con:

    -   Fiebre referida o constatada \>= 38°C; y
    -   Tos; y
    -   Inicio del cuadro en los 10 días precedentes; y
    -   Requerimiento de internación por criterio clínico

2.  **Infección Respiratoria Aguda Grave (IRAG) extendida en \< 2 años y \>= 60 años:**

    -   Infección respiratoria: definida por tos o dificultad respiratoria; e
    -   Inicio del cuadro en los 10 días precedentes; y
    -   Requerimiento de internación por criterio clínico

    En lactantes menores de 6 meses también considerar: -Apnea (cese temporal de la respiración por cualquier causa), o -Sepsis (fiebre/hipotermia) y shock y gravemente enfermo sin causa aparente

**Todos los pacientes que cumplen con las definiciones de caso deben ser estudiados para SARS-CoV-2, Influenza y VRS por metodos moleculares.**

Para mayor informacion de la estrategia de vigilancia centinela de IRAG consultar en: https://www.argentina.gob.ar/sites/default/files/guia-uc-irag-vff.pdf

# Análisis de casos notificados

## Grafico Nº 1: Casos de IRAG e IRAG extendida segun Semana Epidemiológica - UC-IRAG `r establecimiento` - SE `r semana_minima` a SE `r semana_maxima`. Año 2025

```{r}
#| label: CASOS POR SE
#| message: false 
#| echo: false
#| warning: false

source("GRAFICO IRAG POR SE INTERACTVIO.R")
GRAFICO_INTERACTIVO_SE

```

Durante el periodo analizado ( `r periodo_min` al `r periodo_max` ), se notificaron un total de `r total_casos` casos, de los cuales el `r prop_IRAG`% correspondieron a casos de IRAG y el `r prop_IRAG_EXT`% a casos de IRAG extendida

## Grafico Nº 2: Casos de IRAG e IRAG extendida segun grupo etario - UC-IRAG `r establecimiento` - SE `r semana_minima` a SE `r semana_maxima`. Año 2025

```{r}
#| label: CASOS POR GRUPO DE EDAD
#| message: false 
#| echo: false
#| warning: false

source("GRAFICO IRAG POR GRUPO DE EDAD INTERACTIVO.R")
GRAFICO_INTERACTIVO_EDAD
```

Del total de casos notificados, el `r prop_casos_pediatricos`% fueron pacientes pediatricos y el `r prop_casos_adultos` % restante pacientes adultos.

## Grafico Nº 3: Casos de IRAG e IRAG extendida notificados con diagnostico etiologico segun agente - UC-IRAG `r establecimiento` - SE `r semana_minima` a SE `r semana_maxima`. Año 2025

```{r}
#| label: CASOS IRAG POR T DE VIRUS Y SE
#| message: false 
#| echo: false
#| warning: false

source("GRAFICO IRAG CASOS POR TIPO DE VIRUS Y SE INTERACTIVO.R")
GRAFICO_INTERACTIVO_VIRUS
```

## Grafico Nº 4: Distribución de agentes etiológicos identificados según grupos etarios en pacientes pediátricos - UC-IRAG `r establecimiento` - SE `r semana_minima` a SE `r semana_maxima`. Año 2025

```{r}
#| label: agentes-etiologicos pediatria 25
#| message: false 
#| echo: false
#| warning: false
#| results: 'asis'


source("DETECCIONES VIRALES EN PEDIATRIA AÑO 2025.R")

grafico_determinaciones_pediatria


```

## Grafico Nº 5: Distribución de agentes etiológicos identificados según grupos etarios en pacientes adultos - UC-IRAG `r establecimiento` - SE `r semana_minima` a SE `r semana_maxima`. Año 2025

```{r}
#| label: agentes-etiologicos-adultos-2025
#| message: false 
#| echo: false
#| warning: false
#| results: 'asis'


source("DETECCIONES VIRALES EN ADULTOS AÑO 2025.R")

grafico_determinaciones_adultos

```
